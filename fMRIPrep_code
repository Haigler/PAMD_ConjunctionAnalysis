
#Build fMRIPrep Singularity Container
singularity build $<FILEPATH>/fmriprep-<VERSION>.simg docker://poldracklab/fmriprep:<VERSION>
TMPDIR=/home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/tmp singularity build /home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/fmriprep-20.1.1.simg docker://poldracklab/fmriprep:20.1.1

#Build MRIqc Singularity Container
singularity build $<FILEPATH>/mriqc-<VERSION>.simg docker://poldracklab/mriqc:<VERSION>
TMPDIR=/home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/tmp singularity build /home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/mriqc-0.15.1.simg docker://poldracklab/mriqc:0.15.1

cd /mnt/magaj/SNAP/Projects/BIDS-Conversion/katie/Code

TMPDIR=/home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/tmp2 \
    singularity run --fakeroot --cleanenv -B /home/katie/prototyping/emotion-reappraisal-IAPS/Data/affectvids:/data,/home/katie/prototyping/emotion-reappraisal-IAPS/Data/affectvids/derivatives:/out,/mnt/magaj/SNAP/Projects/BIDS-Conversion/katie/Code/freesurfer:/freesurfer,/home/katie/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/Code/tmp2:/tmp  fmriprep-20.2.0.simg \
    /data /out \
    participant \
    --participant-label 12 \
    --ignore fieldmaps \
    --ignore slicetiming \
    --output-spaces MNI152NLin2009cAsym \
    --skull-strip-template OASIS30ANTs \
    --bold2t1w-dof 9 \
    --use-aroma \
    --stop-on-first-crash \
    --fs-no-reconall \
    --md-only-boilerplate \
    --notrack \
    --error-on-aroma-warnings \
    --skip_bids_validation \
    --fs-license-file /freesurfer/license.txt \
    --work-dir /tmp/fmriprep

----

singularity run --cleanenv -B /mnt/magaj/prototyping/emotion-reappraisal-IAPS/ mriqc-0.15.1.simg /mnt/magaj/prototyping/emotion-reappraisal-IAPS/Data/rawdata/ /mnt/magaj/prototyping/emotion-reappraisal-IAPS/Data/derivatives/ participant --participant-label 01 --hmc-fsl --work-dir mnt/magaj/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie --no-sub
    
    
#Build Analysis Singularity Container (one subject per container) - check //poldrack lab...
build $<FILEPATHTOSUBJECTDATA>.simg docker://poldracklab/ds003-example:0.0.3

##MRIQC
#Create a batch prescription file
$<FILEPATH>/mriqc.sbatch

#Submit the job to the scheduler - REVIEW MRIQC DOCS
sbatch $<FILEPATH>/mriqc.sbatch

##FMRIPREP - OPT 1

#Create a batch prescription file
$STUDY/fmriprep.sbatch

#Submit the job to the scheduler
sbatch $STUDY/fmriprep.sbatch

##FMRIPREPR - OPT2

singularity build /home/katie/Code/fmriprep-20.1.1.simg docker://poldracklab/fmriprep:20.1.1

singularity run --cleanenv -B /mnt/magaj/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/ fmriprep.simg \

    <path/to/data/dir> <path/to/output/dir> \
    participant \
    --participant-label 01
    --ignore fieldmaps
    --ignore slicetiming
    --output-spaces MNI152NLin2009cAsym
    --bold2t1w-dof 9
    --use-aroma
    --skull-strip-template OASIS30ANTs
    --work-dir /mnt/magaj/prototyping/emotion-reappraisal-IAPS/Projects/Pipeline-Dev-katie/


--dummy-scans
--bold2t1w-init
Possible choices: register, header

Either “register” (the default) to initialize volumes at center or “header” to use the header information when coregistering BOLD to T1w images.
